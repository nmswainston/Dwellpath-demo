@import "tailwindcss";

/* Dark mode is driven by Tailwind's built-in `dark:` variant (configured as `darkMode: "class"`). */

/* ============================================================================
 * SURFACE HIERARCHY SYSTEM
 * ============================================================================
 * 
 * This app uses a semantic surface hierarchy to create visual depth and
 * separation between different UI layers. Each surface has a distinct role:
 * 
 * LIGHT MODE:
 * - background: Lightest surface (#F4EFE6) - App/page background
 * - surface-1: Header/section backgrounds (slightly lighter than bg)
 * - surface-2 (card): Cards and panels (elevated from page)
 * - surface-3 (popover): Modals, popovers, drawers (highest elevation)
 * 
 * DARK MODE (Brand-anchored “Midnight Steel”):
 * - background (base): #1A212D - App/page background
 * - surface-2 (cards/panels): #212A38 - Elevated surfaces
 * - surface-3 (modals/popovers): #263142 - Secondary surfaces / highest elevation
 * 
 * ELEVATION:
 * - Cards use subtle shadows in light mode for depth
 * - Modals/popovers use stronger shadows to appear elevated
 * - Dark mode relies on contrast rather than heavy shadows
 * 
 * BORDERS:
 * - Borders are softened and act as secondary separators
 * - Primary separation comes from surface color differences
 * 
 * USAGE:
 * - Always use semantic tokens: bg-background, bg-card, bg-popover, text-foreground
 * - Never use hardcoded colors: bg-slate-*, bg-zinc-*, bg-gray-*, bg-[#hex]
 * - Dashboard tiles must use bg-card (same as Premium Plans cards)
 * ============================================================================ */

/* Brand Typography */
.font-heading {
  font-family: 'Playfair Display', serif;
}

.font-body {
  font-family: 'Inter', sans-serif;
}

/* Dwellpath Brand Variables - Light Mode */
:root {
  /* Light Mode - Dwellpath Palette */
  /* Background: #F4EFE6 (Light Background), Foreground: #101418 (Ink) or #0B1D3A (Navy) */
  
  /* Brand Sand Accent (Light Mode) - anchored to #DECDAF
   * Use for: borders/dividers, subtle hovers/selected states, pills/badges, focus rings.
   * Avoid for: body text, primary button fills, large “painted” surfaces.
   */
  --brand-sand: 38 42% 78%; /* #DECDAF */
  --brand-sand-hover: 38 30% 92%; /* Light tint for hover + subtle pills */
  --brand-sand-selected: 38 34% 88%; /* Slightly stronger than hover (persistent states) */
  --brand-sand-muted: 38 16% 94%; /* Very subtle warm tint for muted surfaces */
  --brand-sand-border: 38 22% 84%; /* Borders/dividers derived from sand */
  --brand-sand-ring: 38 45% 62%; /* Focus ring derived from sand (visible, premium) */

  /* Surface Hierarchy (Light Mode) - 4-Tier System:
   * --background: Deepest - App/page background (low chroma warm, spacious)
   * --surface-1: Header/section backgrounds (slightly lighter than bg)
   * --surface-2: Cards/tiles (lighter than surface-1, elevated)
   * --surface-3: Modals/popovers (lightest, highest elevation)
   * 
   * Design Principles:
   * - Large surfaces use low chroma (5-8%) to feel spacious, not paint-like
   * - Brand colors (navy/cream) reserved for accents, buttons, primary actions
   * - Subtle elevation via lightness steps, not heavy borders
   * - Each tier is visibly distinct but harmonious
   */
  --background: 38 6% 94%; /* Low chroma warm - App/page background (spacious, not “painted”) */
  --foreground: 210 20% 8%; /* #101418 - Ink (primary text) */
  --surface-1: 38 10% 96%; /* Header/section background (subtle sand lift; still low chroma) */
  --surface: var(--surface-1); /* Alias for backward compatibility */
  --surface-2: 38 8% 98%; /* Card/tile background (elevated, near-neutral) */
  --surface-3: 38 6% 99%; /* Modal/popover background (highest elevation, brightest) */
  --card: var(--surface-2); /* Alias for backward compatibility */
  --card-foreground: 210 20% 8%; /* #101418 - Ink */
  --popover: var(--surface-3); /* Alias for backward compatibility */
  --popover-foreground: 210 20% 8%; /* #101418 - Ink */
  --primary: 218 68% 14%; /* #0B1D3A - Navy (brand color, full chroma for accents) */
  --primary-foreground: 51.4 41.2% 93.3%; /* #F5F3E7 - Cream */
  --secondary: var(--brand-sand-hover); /* Sand-tinted secondary surfaces (pills, secondary buttons) */
  --secondary-foreground: 218 68% 14%; /* #0B1D3A - Navy */
  --muted: var(--brand-sand-muted); /* Muted surfaces (sand-derived, very subtle) */
  --muted-foreground: 210 15% 45%; /* Muted text - one step down from foreground for better hierarchy */
  --accent: var(--brand-sand-hover); /* Subtle hover/selection surface (sand-derived) */
  --accent-foreground: 218 68% 14%; /* #0B1D3A - Navy */
  --destructive: 0 70% 50%; /* Calm red, not alarm red */
  --destructive-foreground: 50 47% 93%; /* #F5F3E7 - Cream */
  --border: var(--brand-sand-border); /* Sand-derived borders/dividers */
  --input: var(--surface-2); /* Input background (matches cards) */
  --ring: var(--brand-sand-ring); /* Sand-derived focus rings */

  /* Semantic aliases (requested) */
  --paper: var(--background);
  --surface-card: var(--card);
  --surface-muted: var(--muted);

  /* Interactive state tokens (hover vs selected/active)
   * Rules:
   * - Hover: temporary/exploratory (lower contrast)
   * - Selected/Active: committed/persistent (higher contrast)
   * - Selected must NOT be only an opacity step from Hover
   * Note: tokens are full CSS colors (not reused surfaces like --muted/--accent).
   */
  --interactive-hover-bg: hsl(var(--brand-sand-hover));
  --interactive-hover-border: hsl(var(--brand-sand-border));
  --interactive-hover-text: hsl(var(--foreground));

  /* For “in-range / soft-selected” contexts (e.g. calendar ranges) */
  --interactive-selected-soft-bg: hsl(var(--brand-sand-hover));

  --interactive-selected-bg: hsl(var(--brand-sand-selected));
  --interactive-selected-border: hsl(var(--brand-sand-ring));
  --interactive-selected-text: hsl(var(--foreground));

  --radius: 0.75rem;

  /* Layout tokens */
  --sidebar-width: 16rem;
  --sidebar-width-mobile: 18rem;
  --sidebar-width-icon: 3rem;

  /*
   * App shell vertical rhythm
   * Keep these in sync with the sidebar layout rows so main content can align
   * to the same horizontal guides without hard-coded pixel offsets.
   */
  --app-shell-sidebar-header-h: 4rem; /* h-16 */
  --app-shell-sidebar-alerts-h: 2.5rem; /* h-10 */
  --app-shell-sidebar-footer-h: 3.5rem; /* h-14 */
  
  /* Status Colors - Subtle, desaturated, cool-toned for data indicators */
  /* These colors are specifically for numeric values, status labels, progress indicators, and small accent dots/icons */
  /* Never use for full card backgrounds or large containers */
  --status-safe: 185 45% 48%; /* Cool teal - Safe/Success states (desaturated teal-cyan) */
  --status-warning: 35 50% 52%; /* Muted amber - Warning/Attention (desaturated, slightly warm) */
  --status-risk: 350 45% 55%; /* Cool rose/coral - Risk/High Attention (desaturated rose, leaning cool) */
  --status-neutral: 215 20% 50%; /* Slate blue-gray - Informational (very desaturated blue-gray) */
}

/* Tailwind v4 theme tokens - Light Mode */
@theme {
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));
  --color-surface-1: hsl(var(--surface-1));
  --color-surface-2: hsl(var(--surface-2));
  --color-surface-3: hsl(var(--surface-3));
  --color-surface: hsl(var(--surface-1)); /* Alias for backward compatibility */
  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));
  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));
  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));
  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));
  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));
  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));
  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));
  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));
  --color-paper: hsl(var(--paper));
  --color-surface-card: hsl(var(--surface-card));
  --color-surface-muted: hsl(var(--surface-muted));
  --color-sand: hsl(var(--brand-sand));
  --color-sand-hover: hsl(var(--brand-sand-hover));
  --color-sand-border: hsl(var(--brand-sand-border));
  --color-sand-ring: hsl(var(--brand-sand-ring));
  /* Brand palette utilities (Tailwind v4 CSS-first theme tokens) */
  --color-brand-navy: #0B1D3A;
  --color-brand-cream: #F5F3E7;
  --radius: var(--radius);
  --color-status-safe: hsl(var(--status-safe));
  --color-status-warning: hsl(var(--status-warning));
  --color-status-risk: hsl(var(--status-risk));
  --color-status-neutral: hsl(var(--status-neutral));
}

/* Dark Mode - Dwellpath “Midnight Steel” Palette (anchored to #1A212D) */
:root.dark {
  /* Core anchor + elevation stack (hex → HSL):
   * - #1A212D (218 27% 14%) base background
   * - #212A38 (217 26% 17%) elevated surfaces (cards/panels)
   * - #263142 (216 27% 20%) secondary surfaces (nested/modals)
   *
   * Design rules:
   * - No warm grays; no pure-white text; no pure-black borders.
   * - Cards are always lighter than the app background.
   * - Borders are “a whisper” (low-contrast separators).
   */

  /* Semantic “branding package” tokens (store as HSL triples for hsl(var(--x)) usage) */
  --bg-midnight-steel: 218 27% 14%; /* #1A212D */
  --surface-elevated: 217 26% 17%; /* #212A38 */
  --surface-secondary: 216 27% 20%; /* #263142 */

  --text-primary: 216 24% 96%; /* #F2F4F7 */
  --text-secondary: 220 16% 82%; /* #C9CED8 */
  --text-muted: 218 13% 65%; /* #9AA3B2 */
  --text-disabled: 218 10% 48%; /* #6E7787 */

  --border-subtle: 216 23% 24%; /* #2E394A */
  --border-strong: 218 22% 29%; /* #3A465A (rare) */

  /* Primary accent (used for primary actions/links in dark mode).
   * Tone rule: keep hue, reduce saturation, avoid neon intensity.
   */
  --accent-primary: 211 58% 60%; /* Muted blue (was neon) */
  --accent-primary-hover: 211 60% 64%; /* Subtle lift on hover */
  --accent-primary-active: 211 56% 56%; /* Slightly deeper active */

  /* Status tones (dark mode): restrained, desaturated, never neon. */
  --status-success: 158 38% 52%;
  --status-warning-brand: 38 55% 54%;
  --status-error: 8 55% 56%;

  /* Shadcn/Tailwind semantic tokens (wired into Tailwind config) */
  --background: var(--bg-midnight-steel);
  --foreground: var(--text-primary);

  --surface-1: var(--surface-elevated);
  --surface: var(--surface-1); /* Alias for backward compatibility */
  --surface-2: var(--surface-elevated);
  --surface-3: var(--surface-secondary);

  --card: var(--surface-2);
  --card-foreground: var(--text-primary);

  --popover: var(--surface-3);
  --popover-foreground: var(--text-primary);

  /* Primary actions / links */
  --primary: var(--accent-primary);
  --primary-foreground: var(--bg-midnight-steel);
  --ring: var(--accent-primary);

  /* Neutral UI roles */
  --secondary: var(--surface-elevated);
  --secondary-foreground: var(--text-primary);
  --muted: var(--surface-secondary);
  --muted-foreground: var(--text-secondary);

  /* “Accent” is used by shadcn as a subtle hover/selection background (NOT the primary blue) */
  --accent: var(--border-subtle);
  --accent-foreground: var(--text-primary);

  --destructive: var(--status-error);
  --destructive-foreground: var(--text-primary);

  --border: var(--border-subtle);
  --input: var(--surface-elevated);

  /* Interactive state tokens (hover vs selected/active) */
  --interactive-hover-bg: hsl(var(--border-subtle) / 0.55);
  --interactive-hover-border: hsl(var(--border-strong) / 0.75);
  --interactive-hover-text: hsl(var(--text-primary));

  --interactive-selected-soft-bg: hsl(var(--surface-secondary) / 0.85);
  --interactive-selected-bg: hsl(var(--border-strong) / 0.55);
  --interactive-selected-border: hsl(var(--border-strong));
  --interactive-selected-text: hsl(var(--text-primary));

  /* Status colors (project semantic names) */
  --status-safe: var(--status-success);
  --status-warning: var(--status-warning-brand);
  --status-risk: var(--status-error);
  /* Info: neutral blue-gray (not the primary action blue) */
  --status-neutral: 215 22% 62%;

  /* Semantic aliases (kept for consistency; dark mode stays centered on #1A212D) */
  --paper: var(--background);
  --surface-card: var(--card);
  --surface-muted: var(--muted);

  /* Brand sand tokens (semantic fallbacks in dark mode; mapped to existing dark palette) */
  --brand-sand: var(--border-strong);
  --brand-sand-hover: var(--border-subtle);
  --brand-sand-selected: var(--border-strong);
  --brand-sand-muted: var(--surface-secondary);
  --brand-sand-border: var(--border-subtle);
  --brand-sand-ring: var(--ring);
}

@layer base {
  * {
    border-color: hsl(var(--border));
  }

  html {
    font-family: 'Inter', sans-serif !important;
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }

  body {
    @apply antialiased text-foreground bg-background transition-colors duration-300;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif !important;
  }

  /* Force Dwellpath fonts globally with !important */
  *,
  *::before,
  *::after {
    font-family: 'Inter', sans-serif !important;
  }

  h1, h2, h3, h4, h5, h6,
  .font-heading,
  .page-title,
  .section-title,
  .card-title,
  [data-testid*="heading"],
  .heading,
  .title {
    font-family: 'Playfair Display', serif !important;
  }

  /* Specific element targeting for body text */
  p, span, div, label, button, input, textarea, select, table, td, th, li, a, small,
  .font-body,
  .page-subtitle,
  .section-subtitle,
  .form-label,
  .card-description,
  .description,
  .subtitle,
  .text-base,
  .text-sm,
  .text-xs,
  .text-lg,
  .text-xl {
    font-family: 'Inter', sans-serif !important;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Playfair Display', Georgia, 'Times New Roman', serif;
    font-weight: 500;
    letter-spacing: -0.025em;
  }

  /* Dwellpath Brand Specific Styles */
  .dwellpath-heading {
    font-family: 'Playfair Display', Georgia, serif;
    font-weight: 300;
    letter-spacing: -0.02em;
  }

  .dwellpath-logo {
    font-family: 'Playfair Display', Georgia, serif;
    font-weight: 400;
    letter-spacing: -0.01em;
  }

  /* Enhanced Button Styles */
  .btn-dwellpath {
    @apply rounded-lg shadow-sm hover:shadow-md transition-all duration-200;
    border-radius: 0.75rem;
  }

  .btn-dwellpath:hover {
    box-shadow: 0 0 0 3px hsl(var(--ring) / 0.25);
  }

  .dark .btn-dwellpath:hover {
    box-shadow: 0 0 0 3px hsl(var(--ring) / 0.3);
  }

  /* Solid Modal Backgrounds - Highest elevation */
  .modal-dwellpath {
    background: hsl(var(--popover));
    border: 1px solid hsl(var(--border));
    /* Elevated shadow for modals in light mode */
    box-shadow: 0 4px 6px -1px hsl(var(--foreground) / 0.08), 0 2px 4px -1px hsl(var(--foreground) / 0.06);
    /* Subtle highlight border for elevation */
    border-top-color: hsl(var(--surface-3) / 0.4);
    border-left-color: hsl(var(--surface-3) / 0.3);
  }

  .dark .modal-dwellpath {
    background: hsl(var(--popover));
    border: 1px solid hsl(var(--border));
    box-shadow: 0 1px 3px 0 hsl(0 0% 0% / 0.4), 0 1px 2px 0 hsl(0 0% 0% / 0.3);
  }

  /* Form Input Enhancements */
  .input-dwellpath {
    @apply rounded-lg border border-input px-4 py-3 text-sm transition-colors;
    background: hsl(var(--background));
  }

  .input-dwellpath:focus {
    /* Quiet focus: thin ring, minimal offset (keeps visibility without shouting). */
    @apply ring-1 ring-ring ring-offset-1;
    border-color: hsl(var(--ring));
  }

  /* Navigation Styling - Uses surface-1 for subtle elevation */
  .nav-dwellpath {
    background: hsl(var(--surface-1)); /* Slightly elevated from page background */
    border-right: 1px solid hsl(var(--border));
    /* Subtle sidebar shadow in light mode */
    box-shadow: 1px 0 2px 0 hsl(var(--foreground) / 0.04);
    /* Very subtle top highlight */
    border-top-color: hsl(var(--surface-2) / 0.2);
  }

  .dark .nav-dwellpath {
    background: hsl(var(--background)); /* Match page background - RESTORED */
    border-right: 1px solid hsl(var(--border));
    box-shadow: 1px 0 3px 0 hsl(0 0% 0% / 0.3); /* RESTORED */
  }

  /* Dropdown and Popover Solid Backgrounds */
  [data-radix-popper-content-wrapper],
  [data-radix-select-content],
  [data-radix-dropdown-menu-content],
  [data-radix-popover-content],
  [data-radix-tooltip-content],
  [data-radix-command-list] {
    background: hsl(var(--popover)) !important;
    border: 1px solid hsl(var(--border)) !important;
    /* Elevated shadow for popovers in light mode */
    box-shadow: 0 4px 6px -1px hsl(var(--foreground) / 0.08), 0 2px 4px -1px hsl(var(--foreground) / 0.06) !important;
  }

  .dark [data-radix-popper-content-wrapper],
  .dark [data-radix-select-content],
  .dark [data-radix-dropdown-menu-content],
  .dark [data-radix-popover-content],
  .dark [data-radix-tooltip-content],
  .dark [data-radix-command-list] {
    background: hsl(var(--popover)) !important;
    border: 1px solid hsl(var(--border)) !important;
    /* Dark mode popover shadow */
    box-shadow: 0 4px 6px -1px hsl(0 0% 0% / 0.4), 0 2px 4px -1px hsl(0 0% 0% / 0.3) !important;
  }

  /* Menu Item Hover States */
  [data-radix-dropdown-menu-item]:hover:not([data-state='checked']):not([aria-selected='true']),
  [data-radix-select-item]:hover:not([data-state='checked']):not([aria-selected='true']),
  [data-radix-command-item]:hover {
    background: var(--interactive-hover-bg) !important;
    color: var(--interactive-hover-text) !important;
  }

  .dark [data-radix-dropdown-menu-item]:hover:not([data-state='checked']):not([aria-selected='true']),
  .dark [data-radix-select-item]:hover:not([data-state='checked']):not([aria-selected='true']),
  .dark [data-radix-command-item]:hover {
    background: var(--interactive-hover-bg) !important;
    color: var(--interactive-hover-text) !important;
  }

  /* Menu Item Selected/Checked States (must not look like hover) */
  [data-radix-dropdown-menu-item][data-state="checked"],
  [data-radix-select-item][data-state="checked"] {
    background: var(--interactive-selected-bg) !important;
    color: var(--interactive-selected-text) !important;
  }

  [data-radix-dropdown-menu-item][data-state="checked"]:hover,
  [data-radix-select-item][data-state="checked"]:hover {
    background: var(--interactive-selected-bg) !important;
    color: var(--interactive-selected-text) !important;
  }

  /* Command palette highlighted item (temporary/hover-like, NOT selected) */
  [cmdk-item][data-selected="true"],
  [data-radix-command-item][aria-selected="true"] {
    background: var(--interactive-hover-bg) !important;
    color: var(--interactive-hover-text) !important;
  }

  [cmdk-item][data-selected="true"]:hover,
  [data-radix-command-item][aria-selected="true"]:hover {
    background: var(--interactive-hover-bg) !important;
    color: var(--interactive-hover-text) !important;
  }

  /* Form Select Elements */
  select,
  [data-radix-select-trigger] {
    background: hsl(var(--background)) !important;
    border: 1px solid hsl(var(--border)) !important;
  }

  .dark select,
  .dark [data-radix-select-trigger] {
    background: hsl(var(--input)) !important;
    border: 1px solid hsl(var(--border)) !important;
    color: hsl(var(--foreground)) !important;
  }

  /* Select Dropdown Text Color Fixes - Using semantic tokens */
  .dark [data-radix-select-content],
  .dark [data-radix-select-item],
  .dark [data-radix-select-item] *,
  .dark [data-radix-select-value],
  .dark [data-radix-select-label],
  .dark [data-radix-select-content] *,
  .dark [data-radix-select-viewport],
  .dark [data-radix-select-viewport] *,
  .dark [data-radix-select-trigger][data-placeholder],
  .dark [data-radix-command-list],
  .dark [data-radix-command-item],
  .dark [data-radix-popover-content],
  .dark [data-radix-dropdown-menu-content],
  .dark [data-radix-dropdown-menu-item],
  .dark [role="option"],
  .dark [role="listbox"],
  .dark [role="combobox"],
  .dark [data-state="open"],
  .dark [data-state="open"] *,
  .dark [data-radix-popper-content-wrapper],
  .dark [data-radix-popper-content-wrapper] *,
  .dark div[role="listbox"],
  .dark div[role="listbox"] *,
  .dark div[role="option"],
  .dark div[role="option"] *,
  .dark [data-radix-select-portal],
  .dark [data-radix-select-portal] *,
  .dark body [data-radix-select-content],
  .dark body [data-radix-select-content] *,
  .dark [style*="z-index"] [data-radix-select-item],
  .dark [style*="z-index"] [data-radix-select-item] * {
    color: hsl(var(--foreground)) !important;
  }

  /* Dialog/Modal Backgrounds */
  .dialog-content,
  [data-radix-dialog-content] {
    background: hsl(var(--popover)) !important;
    border: 1px solid hsl(var(--border)) !important;
    /* Elevated shadow for dialogs in light mode */
    box-shadow: 0 10px 15px -3px hsl(var(--foreground) / 0.1), 0 4px 6px -2px hsl(var(--foreground) / 0.08) !important;
  }

  .dark .dialog-content,
  .dark [data-radix-dialog-content] {
    background: hsl(var(--popover)) !important;
    border: 1px solid hsl(var(--border)) !important;
    /* Dark mode dialog shadow */
    box-shadow: 0 10px 15px -3px hsl(0 0% 0% / 0.5), 0 4px 6px -2px hsl(0 0% 0% / 0.4) !important;
  }

  /* Dark Mode Border and Contrast Fixes - Using theme tokens */
  .dark .border {
    border-color: hsl(var(--border)); /* Uses theme token */
  }
  
  /* No `border-border` utility in Tailwind v4; use variable-driven border colors directly. */
  
  .dark .border-slate-200 {
    border-color: hsl(var(--border)); /* Uses theme token */
  }
  
  .dark .border-slate-300 {
    border-color: hsl(var(--border)); /* Uses theme token */
  }
  
  .dark .border-gray-200 {
    border-color: hsl(var(--border)); /* Uses theme token */
  }
  
  .dark .border-gray-300 {
    border-color: hsl(var(--border)); /* Uses theme token */
  }
  
  .dark .divide-slate-200 > :not([hidden]) ~ :not([hidden]) {
    border-color: hsl(var(--border)); /* Uses theme token */
  }
  
  .dark .divide-gray-200 > :not([hidden]) ~ :not([hidden]) {
    border-color: hsl(var(--border)); /* Uses theme token */
  }

  /* Table borders - Using theme tokens */
  .dark .border-collapse td,
  .dark .border-collapse th {
    border-color: hsl(var(--border)); /* Uses theme token */
  }

  /* Card and component borders - Using theme tokens */
  .dark [class*="border"] {
    border-color: hsl(var(--border)); /* Uses theme token */
  }

  /* Specific component overrides - Removed hardcoded graphite, using theme tokens */
  .dark .bg-card {
    background-color: hsl(var(--card)); /* Uses theme token */
    border-color: hsl(var(--border)); /* Uses theme token */
  }

  .dark .bg-popover {
    background-color: hsl(var(--popover)); /* Uses theme token */
    border-color: hsl(var(--border)); /* Uses theme token */
  }

  /* Enhanced card and component styling */
  .dark .shadow-sm {
    box-shadow: 0 1px 2px 0 hsl(0 0% 0% / 0.2);
  }

  .dark .shadow {
    box-shadow: 0 1px 3px 0 hsl(0 0% 0% / 0.3), 0 1px 2px -1px hsl(0 0% 0% / 0.3);
  }

  .dark .shadow-lg {
    box-shadow: 0 10px 15px -3px hsl(0 0% 0% / 0.3), 0 4px 6px -4px hsl(0 0% 0% / 0.3);
  }

  /* Ring and focus states */
  .dark .ring-blue-500 {
    --tw-ring-color: hsl(var(--ring));
  }

  .dark .ring-blue-300 {
    --tw-ring-color: hsl(var(--ring));
  }

  /* Status Color Utility Classes - For data indicators only (text, icons, small accents) */
  .text-status-safe {
    color: hsl(var(--status-safe));
  }
  
  .text-status-warning {
    color: hsl(var(--status-warning));
  }
  
  .text-status-risk {
    color: hsl(var(--status-risk));
  }
  
  .text-status-neutral {
    color: hsl(var(--status-neutral));
  }
  
  /* Status Badge Classes - For small status labels and badges */
  .state-badge {
    @apply px-2 py-1 rounded-md text-xs font-semibold uppercase tracking-wide;
  }
  
  .risk-low,
  .status-safe {
    background-color: hsl(var(--status-safe) / 0.1);
    color: hsl(var(--status-safe));
    border: 1px solid hsl(var(--status-safe) / 0.2);
  }
  
  .risk-medium,
  .status-warning {
    background-color: hsl(var(--status-warning) / 0.1);
    color: hsl(var(--status-warning));
    border: 1px solid hsl(var(--status-warning) / 0.2);
  }
  
  .risk-critical,
  .status-risk {
    background-color: hsl(var(--status-risk) / 0.1);
    color: hsl(var(--status-risk));
    border: 1px solid hsl(var(--status-risk) / 0.2);
  }
  
  /* Status and accent colors - Dark mode mappings (brand-aligned) */
  .dark .bg-blue-50 {
    background-color: hsl(var(--primary) / 0.12);
  }

  .dark .bg-red-50 {
    background-color: hsl(var(--destructive) / 0.12);
  }

  .dark .bg-yellow-50 {
    background-color: hsl(var(--status-warning) / 0.12);
  }

  .dark .text-blue-600 {
    color: hsl(var(--primary));
  }

  .dark .text-red-600 {
    color: hsl(var(--destructive));
  }

  .dark .text-yellow-600 {
    color: hsl(var(--status-warning));
  }

  /* Icons: avoid global “boost” filters; rely on semantic icon colors instead. */

}

/* Ensure all dropdown and popover components have solid backgrounds */
[data-radix-select-content],
[data-radix-dropdown-menu-content],
[data-radix-popover-content] {
  background: hsl(var(--card)) !important;
  border: 1px solid hsl(var(--border)) !important;
}

/* Additional fallbacks for any other dropdown-like components */
.bg-popover {
  background: hsl(var(--card)) !important;
}

/* Dark mode specific overrides for dropdowns */
.dark [data-radix-select-content],
.dark [data-radix-dropdown-menu-content],
.dark [data-radix-popover-content] {
  background: hsl(var(--card)) !important;
  border: 1px solid hsl(var(--border)) !important;
}

/* Ensure toast notifications are always visible with proper z-index */
[data-radix-toast-viewport] {
  z-index: 999999 !important;
}

[data-radix-toast-root] {
  z-index: 999999 !important;
  background: hsl(var(--card)) !important;
  border: 1px solid hsl(var(--border)) !important;
}

.dark [data-radix-toast-root] {
  background: hsl(var(--card)) !important;
  border: 1px solid hsl(var(--border)) !important;
}

/* Animations */
.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-in {
  animation: slideIn 0.25s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: hsl(var(--muted));
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--muted-foreground) / 0.3);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground) / 0.5);
}

.dark ::-webkit-scrollbar-thumb {
  background: hsl(var(--muted-foreground) / 0.4);
}

.dark ::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground) / 0.6);
}

/* Custom Scrollbar (deduped: duplicate block removed; behavior unchanged) */

/* Utility Classes */

/* Numeric Typography
 * - Use tabular + lining numerals for consistent alignment (tables, totals, currency).
 * - Keep font-family aligned with body typography; use `.numeric-display` for prominent figures.
 */
@layer utilities {
  .numeric {
    font-variant-numeric: tabular-nums lining-nums;
    font-feature-settings: "tnum" 1, "lnum" 1;
  }

  .numeric-display {
    font-family: "Inter", sans-serif !important;
    font-variant-numeric: tabular-nums lining-nums;
    font-feature-settings: "tnum" 1, "lnum" 1;
  }

  .scrollbar-hide {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
}

/* Professional button spacing and typography */
.btn-primary {
  font-weight: 600;
  letter-spacing: -0.01em;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  transition: all 0.2s ease-in-out;
}

.btn-secondary {
  font-weight: 500;
  letter-spacing: -0.01em;
  padding: 0.625rem 1.25rem;
  border-radius: 0.5rem;
  transition: all 0.2s ease-in-out;
}

/* Consistent heading hierarchy */
.page-title {
  font-size: 1.875rem;
  font-weight: 700;
  letter-spacing: -0.025em;
  line-height: 1.2;
  margin-bottom: 0.5rem;
}

.page-subtitle {
  font-size: 1rem;
  font-weight: 400;
  opacity: 0.8;
  margin-bottom: 2rem;
}

.section-title {
  font-size: 1.25rem;
  font-weight: 600;
  letter-spacing: -0.02em;
  line-height: 1.3;
  margin-bottom: 0.375rem;
}

.section-subtitle {
  font-size: 0.875rem;
  font-weight: 400;
  opacity: 0.7;
  margin-bottom: 1rem;
}

/* Form spacing and consistency - Use space-y-2 for form fields */
.form-label {
  font-weight: 500;
  font-size: 0.875rem;
  display: block;
}

/* Card grid improvements */
.card-grid {
  display: grid;
  gap: 1.5rem;
}

.card-grid-2 {
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
}

.card-grid-3 {
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
}

.card-grid-4 {
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

/* Card content wrapping improvements */
.card-meta-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  align-items: center;
}

.card-meta-row > * {
  flex-shrink: 0;
}

/* Prevent awkward text wrapping in card headers */
.card-header-content {
  min-width: 0;
  flex: 1 1 0%;
}

.card-header-action {
  flex-shrink: 0;
}

/* Enhanced visibility for icons in dark mode: handled per-component via semantic colors. */

/* Dwellpath Hero Gradient - Custom gradient class for hero sections */
.dwellpath-hero-gradient {
  background: linear-gradient(135deg, hsl(220 26% 14%) 0%, hsl(215 25% 27%) 35%, hsl(210 40% 98%) 100%);
}

.dark .dwellpath-hero-gradient {
  background: linear-gradient(
    135deg,
    hsl(var(--background)) 0%,
    hsl(var(--surface-1)) 55%,
    hsl(var(--surface-3)) 100%
  );
}

/* Page Container - Standardized spacing between sections */
.page-container {
  width: 100%;
}

/* Modal / overlay backdrop (avoid inline styles) */
.overlay-backdrop {
  background-color: rgba(0, 0, 0, 0.4);
}

/* Landing page styling (centralized; avoids inline styles) */
.landing-gradient {
  background: linear-gradient(
    135deg,
    hsl(220 26% 14%) 0%,
    hsl(215 25% 27%) 35%,
    hsl(210 40% 98%) 100%
  );
}

.landing-title {
  color: hsl(210 40% 98%);
}

.landing-subtitle {
  color: hsl(214 32% 91%);
}

.landing-copy {
  color: hsl(213 27% 84%);
}

.landing-feature-icon {
  /* Calm, brand-adjacent accent on dark hero (avoid bright cyan). */
  color: hsl(213 27% 84%);
}

.landing-feature-title {
  color: hsl(210 40% 98%);
}

.landing-feature-desc {
  color: hsl(213 27% 84%);
}

/* Animation delay helpers (avoid inline style for delays) */
.anim-delay-100 {
  animation-delay: 0.1s;
}
.anim-delay-200 {
  animation-delay: 0.2s;
}
.anim-delay-300 {
  animation-delay: 0.3s;
}
.anim-delay-400 {
  animation-delay: 0.4s;
}

/* Onboarding tour icon wrapper (avoid inline sizing) */
.onboarding-icon-wrap {
  width: 48px;
  height: 48px;
  padding: 6px;
}

/* Layout Utilities */
.section-spacing {
  @apply mb-6;
}

.header-spacing {
  @apply mb-4;
}

.grid-flow-4 {
  @apply grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4;
}

.grid-flow-2 {
  @apply grid grid-cols-1 lg:grid-cols-2 gap-4;
}

.grid-flow-3 {
  @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4;
}

/* Compact spacing for better fitting */
.compact-spacing {
  @apply space-y-3;
}

.tight-grid {
  @apply gap-3;
}

/* Responsive Design */
@media (max-width: 1024px) {
  .grid-flow-4 {
    @apply grid-cols-1 md:grid-cols-2;
  }
  
  .grid-flow-3 {
    @apply grid-cols-1 md:grid-cols-2;
  }
}

@media (max-width: 768px) {
  .page-container {
    @apply space-y-3;
  }
  
  .section-spacing {
    @apply mb-4;
  }
  
  .header-spacing {
    @apply mb-2;
  }
  
  .grid-flow-4,
  .grid-flow-3,
  .grid-flow-2 {
    @apply grid-cols-1 gap-3;
  }
  
  /* Mobile sidebar adjustments */
  .mobile-content-shift {
    margin-left: 0 !important;
  }
}

/* Winter Card - Consistent styling for all cards with subtle elevation */
.winter-card {
  @apply rounded-xl border bg-card;
  border-color: hsl(var(--border));
  background-color: hsl(var(--card));
  overflow: hidden;
  /* Subtle elevation: soft shadow + very subtle highlight border */
  box-shadow: 0 1px 3px 0 hsl(var(--foreground) / 0.06), 0 1px 2px 0 hsl(var(--foreground) / 0.04);
  /* Very subtle top/left highlight for depth */
  border-top-color: hsl(var(--surface-3) / 0.3);
  border-left-color: hsl(var(--surface-3) / 0.2);
}

.dark .winter-card {
  background-color: hsl(var(--card));
  border-color: hsl(var(--border));
  /* Dark mode: subtle shadow */
  box-shadow: 0 1px 3px 0 hsl(0 0% 0% / 0.4), 0 1px 2px 0 hsl(0 0% 0% / 0.3);
  /* Very subtle top/left highlight for depth (keeps borders whisper-quiet) */
  border-top-color: hsl(var(--surface-3) / 0.25);
  border-left-color: hsl(var(--surface-3) / 0.18);
}